CONTRACT_TYPE
{
	name = kumIslandAirfield

	title = "Interrupt the Takeover of the Island Airfield"
	genericTitle = "Island Airfield Takeover"

	group = munistorumConventional
	agent = komUniMun

	description = "Recently, an enemy force has deployed multiple coastal artillery positions to the airfield in the islands east of the KSC, we have confirmed Anti-Aircraft weaponry as well." + "\nThis threatens the KSC and any future launches, as such, these units must be dealt with." + "\n\nReclaim the area through any means necessary." + "\n\nMission Latitude: -2" +"\nMission Longitude: -72"
	genericDescription = "Engage the enemy force in the airfield island chain east of the KSC."

	topic = Weapons
	subject = Experiment

	synopsis = "Engage the enemy force in the airfield island chain east of the KSC."
	notes = "It is recommended that you use air-to-surface or surface-to-surface ordnance for this mission."

	completedMessage = "Mission accomplished! We have successfully retaken the airfield island chain, our future operations are no longer threatened!"

	minExpiry = 3.0
	maxExpiry = 7.0

	cancellable = true
	declinable = true

	targetBody = HomeWorld()

	maxCompletions = 0
	maxSimultaneous = 1

	// Data node for the rewards
	DATA
	{
		type = double

		science = 0.0 // Zero for non-test missions
		reputation = 13 * Random(0.8, 1.2)
		funds = 28000 * Random(0.8, 1.2)
	}

	// Name Safety
	DATA
	{
		type = int

		nameAppend = Random(0, 65535)

		hidden = true
	}

	// Target Names
	DATA
	{
		type = string
		title = "Target vessels"

		targetArtillery1 = "Artillery 1" + " ID: " + @/nameAppend
		targetArtillery2 = "Artillery 2" + " ID: " + @/nameAppend
		targetArtillery3 = "Artillery 3" + " ID: " + @/nameAppend
		targetArtillery4 = "Artillery 4" + " ID: " + @/nameAppend
		targetArtillery5 = "Artillery 5" + " ID: " + @/nameAppend
		targetArtillery6 = "Artillery 6" + " ID: " + @/nameAppend
		targetArtillery7 = "Artillery 7" + " ID: " + @/nameAppend

		targetAAA1 = "AAA 1" + " ID: " + @/nameAppend
		targetAAA2 = "AAA 2" + " ID: " + @/nameAppend
		targetAAA3 = "AAA 3" + " ID: " + @/nameAppend

		targetCIWS = "CIWS 1" + " ID: " + @/nameAppend
	}

	// Vehicle Lists
	DATA
	{
		type = List<string>

		artilleryList = @/munistorumDataStore:coastHowitzerList
		aaaList = @/munistorumDataStore:aaaList
		ciwsList = @/munistorumDataStore:ciwsList
	}

	// Vehicle Positions
	DATA
	{
		type = double

		artillery1Lat = -2.298756
		artillery1Lon = -72.657038
		artillery1Hdg = 40

		artillery2Lat = -1.503315
		artillery2Lon = -71.816636
		artillery2Hdg = 50

		artillery3Lat = -1.518136
		artillery3Lon = -71.968147
		artillery3Hdg = 277

		artillery4Lat = -1.620935
		artillery4Lon = -71.702422
		artillery4Hdg = 90

		artillery5Lat = -1.511657
		artillery5Lon = -71.815134
		artillery5Hdg = 53

		artillery6Lat = -1.499843
		artillery6Lon = -71.822940
		artillery6Hdg = 4

		artillery7Lat = -1.548969
		artillery7Lon = -71.983466
		artillery7Hdg = 278

		artillery8Lat = -2.296065
		artillery8Lon = -72.678397
		artillery8Hdg = 346

		AAA1Lat = -1.578383
		AAA1Lon = -71.927414
		AAA1Hdg = 130

		AAA2Lat = -1.535801
		AAA2Lon = -71.936339
		AAA2Hdg = 70

		AAA3Lat = -1.518950
		AAA3Lon = -71.895580
		AAA3Hdg = 0

		ciwsLat = -1.758010
		ciwsLon = -71.983383
		ciwsHdg = 270
	}

	// Requirement node for contract prerequisites
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = kumInterceptors
	}

	// Value definitions
	rewardScience = @/science
	rewardReputation = @/reputation
	rewardFunds = @/funds

	failureReputation = @/reputation / 4
	failureFunds = @/funds / 8
	advanceFunds = @/funds / 4
	
	// Behaviour such as vessel location, name etc

	// Artillery sites
	BEHAVIOUR
	{
		name = SpawnArtillery
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetArtillery1
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/artilleryList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/artillery1Lat
			lon = @/artillery1Lon
			height = 5

			heading = @/artillery1Hdg
		}

		VESSEL
		{
			name = @/targetArtillery2
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/artilleryList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/artillery2Lat
			lon = @/artillery2Lon
			height = 5

			heading = @/artillery2Hdg
		}

		VESSEL
		{
			name = @/targetArtillery3
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/artilleryList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/artillery3Lat
			lon = @/artillery3Lon
			height = 5

			heading = @/artillery3Hdg
		}

		VESSEL
		{
			name = @/targetArtillery4
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/artilleryList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/artillery4Lat
			lon = @/artillery4Lon
			height = 5

			heading = @/artillery4Hdg
		}

		VESSEL
		{
			name = @/targetArtillery5
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/artilleryList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/artillery5Lat
			lon = @/artillery5Lon
			height = 5

			heading = @/artillery5Hdg
		}

		VESSEL
		{
			name = @/targetArtillery6
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/artilleryList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/artillery6Lat
			lon = @/artillery6Lon
			height = 5

			heading = @/artillery6Hdg
		}

		VESSEL
		{
			name = @/targetArtillery7
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/artilleryList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/artillery7Lat
			lon = @/artillery7Lon
			height = 5

			heading = @/artillery7Hdg
		}
	}

	// AAA sites
	BEHAVIOUR
	{
		name = SpawnAAA
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetAAA1
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/aaaList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/AAA1Lat
			lon = @/AAA1Lon
			height = 5

			heading = @/AAA1Hdg
		}

		VESSEL
		{
			name = @/targetAAA2
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/aaaList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/AAA2Lat
			lon = @/AAA2Lon
			height = 5

			heading = @/AAA2Hdg
		}

		VESSEL
		{
			name = @/targetAAA3
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/aaaList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/AAA3Lat
			lon = @/AAA3Lon
			height = 5

			heading = @/AAA3Hdg
		}
	}

	// CIWS site
	BEHAVIOUR
	{
		name = SpawnCIWS
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetCIWS
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/ciwsList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/ciwsLat
			lon = @/ciwsLon
			height = 5

			heading = @/ciwsHdg
		}
	}

	// Destroy all mission vessels for safety
	BEHAVIOUR
	{
		name = ContingencyCleanup
		type = DestroyVessel

		onState = PARAMETER_COMPLETED
		parameter = DestroyCraft

		vessel = @/targetArtillery1
		vessel = @/targetArtillery2
		vessel = @/targetArtillery3
		vessel = @/targetArtillery4
		vessel = @/targetArtillery5
		vessel = @/targetArtillery6
		vessel = @/targetArtillery7

		vessel = @/targetAAA1
		vessel = @/targetAAA2
		vessel = @/targetAAA3

		vessel = @/targetCIWS
	}

	// Parameters for completing the contract

	// Combat parameters
	PARAMETER
	{
		name = CombatSequence
		type = Sequence

		title = "Eliminate the enemy force"

		hiddenParameter = DestroyCraft

		PARAMETER
		{
			name = DestroyCraft
			type = TargetDestroyed

			title = "Eliminate the enemy"

			vessel = @/targetArtillery1
			vessel = @/targetArtillery2
			vessel = @/targetArtillery3
			vessel = @/targetArtillery4
			vessel = @/targetArtillery5
			vessel = @/targetArtillery6
			vessel = @/targetArtillery7

			vessel = @/targetAAA1
			vessel = @/targetAAA2
			vessel = @/targetAAA3

			vessel = @/targetCIWS
		}

		// Parameter for recovering the vessel after the mission
		PARAMETER
		{
			name = ToBase
			type = All

			title = "Land the vessel and recover it safely on Kerbin"

			disableOnStateChange = true
			completeInSequence = true

			PARAMETER
			{
				name = LandBase
				type = ReturnHome

				title = "Stop the vessel on the surface"
			}

			PARAMETER
			{
				name = RecoverBase
				type = RecoverVessel

				title = "Recover the vessel"
				completedMessage = "The vessel was successfully recovered!"
			}
		}
	}
}
