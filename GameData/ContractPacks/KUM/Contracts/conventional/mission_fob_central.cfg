CONTRACT_TYPE
{
	name = kumFobCentral

	title = "Destroy the FOB in Central Kerbin"
	genericTitle = "FOB in Central Kerbin"

	group = munistorumConventional
	agent = komUniMun

	description = "Recently, an outpost was discovered together with the aerial assault group sent to attack the KSC, it is located to the north-west of the KSC." + "\nThis outpost contains a missile launcher which is in attack range of the KSC." + "\nApproach the outpost and destroy it ASAP, it poses a severe threat to our operations which cannot be tolerated!" + "\nDestroy the enemy outpost to secure Kerbin from their forces once more!" + "\n\nMission Latitude: " + @titleLat + "\nMission Longitude: " + @titleLon
	genericDescription = "Destroy the FOB and the missile launcher in central Kerbin."

	topic = Weapons
	subject = Experiment

	synopsis = "Destroy the FOB and the missile launcher in central Kerbin."
	notes = "It is recommended that you use air-to-surface or surface-to-surface ordnance for this mission."

	completedMessage = "Mission accomplished! The missile launcher and outpost have been cleaned up successfully."

	minExpiry = 3.0
	maxExpiry = 7.0

	cancellable = true
	declinable = true

	targetBody = HomeWorld()

	maxCompletions = 0
	maxSimultaneous = 1

	// Data node for the rewards
	DATA
	{
		type = double

		science = 0.0 // Zero for non-test missions
		reputation = 13 * Random(0.8, 1.2)
		funds = 28000 * Random(0.8, 1.2)
	}

	// Name Safety
	DATA
	{
		type = int

		nameAppend = Random(0, 65535)

		hidden = true
	}

	// Target Names
	DATA
	{
		type = string
		title = "Target vessels"

		targetFOB = "FOB 1" + " ID: " + @/nameAppend

		targetHowitzer1 = "Howitzer 1" + " ID: " + @/nameAppend
		targetHowitzer2 = "Howitzer 2" + " ID: " + @/nameAppend

		targetAtgm1 = "ATGM 1" + " ID: " + @/nameAppend
		targetAtgm2 = "ATGM 2" + " ID: " + @/nameAppend

		targetUGV1 = "UGV 1" + " ID: " + @/nameAppend
		targetUGV2 = "UGV 2" + " ID: " + @/nameAppend
		targetUGV3 = "UGV 3" + " ID: " + @/nameAppend

		targetCIWS = "CIWS 1" + " ID: " + @/nameAppend
		targetLauncher = "Launcher 1" + " ID: " + @/nameAppend

		targetSAM = "SAM 1" + " ID: " + @/nameAppend
		targetRadar = "Radar 1" + " ID: " + @/nameAppend
	}

	// Vehicle Lists
	DATA
	{
		type = List<string>

		baseList = @/munistorumDataStore:baseList.Concat(@/munistorumDataStore:outpostList)

		atgmList = @/munistorumDataStore:atgmList
		howitzerList = @/munistorumDataStore:howitzerList.Concat(@/munistorumDataStore:coastHowitzerList)

		radarList = @/munistorumDataStore:radarList.Concat(@/munistorumDataStore:spradStaticList)
		samList = @/munistorumDataStore:samList.Concat(@/munistorumDataStore:spadStaticList)
		ugvList = @/munistorumDataStore:ugvList
		ciwsList = @/munistorumDataStore:ciwsList
		launcherList = @/munistorumDataStore:launcherStaticList
	}

	// Vehicle Positions
	DATA
	{
		type = double

		squadLat = Random(8.0, 17.5)
		squadLon = Random(-83.9, -76.7)
		squadHdg = Random(125.0, 145.0)

		squadOffset = 0.2
	}

	// Title Coordinates
	DATA
	{
		type = double

		titleLat = Round(@squadLat)
		titleLon = Round(@squadLon)
	}

	// Requirement node for contract prerequisites
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = kumInterceptors
	}

	// Value definitions
	rewardScience = @/science
	rewardReputation = @/reputation
	rewardFunds = @/funds

	failureReputation = @/reputation / 4
	failureFunds = @/funds / 8
	advanceFunds = @/funds / 4
	
	// Behaviour such as vessel location, name etc

	// FOB
	BEHAVIOUR
	{
		name = SpawnFOB
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetFOB
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/baseList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat
			lon = @/squadLon
			height = 5

			heading = @/squadHdg
		}
	}

	// Howitzers
	BEHAVIOUR
	{
		name = SpawnHowitzer
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetHowitzer1
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/howitzerList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat + @/squadOffset
			lon = @/squadLon
			height = 5

			heading = @/squadHdg
		}

		VESSEL
		{
			name = @/targetHowitzer2
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/howitzerList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat - @/squadOffset
			lon = @/squadLon

			height = 5

			heading = @/squadHdg
		}
	}

	// ATGMs
	BEHAVIOUR
	{
		name = SpawnATGM
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetAtgm1
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/atgmList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat + @/squadOffset
			lon = @/squadLon + 0.05
			height = 5

			heading = @/squadHdg
		}

		VESSEL
		{
			name = @/targetAtgm2
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/atgmList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat - @/squadOffset
			lon = @/squadLon - 0.05
			height = 5

			heading = @/squadHdg
		}
	}

	// UGVs
	BEHAVIOUR
	{
		name = SpawnAAA
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetUGV1
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/ugvList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat
			lon = @/squadLon + @/squadOffset
			height = 5

			heading = @/squadHdg
		}

		VESSEL
		{
			name = @/targetUGV2
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/ugvList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat
			lon = @/squadLon + @/squadOffset + 0.05
			height = 5

			heading = @/squadHdg
		}

		VESSEL
		{
			name = @/targetUGV3
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/ugvList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat
			lon = @/squadLon + @/squadOffset + 0.1
			height = 5

			heading = @/squadHdg
		}
	}

	// CIWS
	BEHAVIOUR
	{
		name = SpawnCIWS
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetCIWS
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/ciwsList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat - @/squadOffset
			lon = @/squadLon - @/squadOffset
			height = 5

			heading = @/squadHdg
		}
	}

	// Launcher
	BEHAVIOUR
	{
		name = SpawnLauncher
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetLauncher
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/launcherList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat - @/squadOffset - 0.05
			lon = @/squadLon - @/squadOffset
			height = 5

			heading = @/squadHdg
		}
	}

	// SAM
	BEHAVIOUR
	{
		name = SpawnSAM
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetSAM
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/samList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat + @/squadOffset
			lon = @/squadLon + @/squadOffset
			height = 5

			heading = @/squadHdg
		}

		VESSEL
		{
			name = @/targetRadar
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/radarList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/squadLat + @/squadOffset + 0.002
			lon = @/squadLon + @/squadOffset + 0.002
			height = 5

			heading = @/squadHdg
		}
	}

	// Destroy all mission vessels for safety
	BEHAVIOUR
	{
		name = ContingencyCleanup
		type = DestroyVessel

		onState = PARAMETER_COMPLETED
		parameter = DestroyCraft

		vessel = @/targetFOB

		vessel = @/targetHowitzer1
		vessel = @/targetHowitzer2

		vessel = @/targetAtgm1
		vessel = @/targetAtgm2

		vessel = @/targetUGV1
		vessel = @/targetUGV2
		vessel = @/targetUGV3

		vessel = @/targetCIWS
		vessel = @/targetLauncher

		vessel = @/targetSAM
		vessel = @/targetRadar
	}

	// Parameters for completing the contract

	// Combat parameters
	PARAMETER
	{
		name = CombatSequence
		type = Sequence

		title = "Eliminate the enemy force"

		hiddenParameter = DestroyCraft

		PARAMETER
		{
			name = DestroyCraft
			type = TargetDestroyed

			title = "Eliminate the enemy"

			vessel = @/targetFOB

			vessel = @/targetHowitzer1
			vessel = @/targetHowitzer2

			vessel = @/targetAtgm1
			vessel = @/targetAtgm2

			vessel = @/targetUGV1
			vessel = @/targetUGV2
			vessel = @/targetUGV3

			vessel = @/targetCIWS
			vessel = @/targetLauncher

			vessel = @/targetSAM
			vessel = @/targetRadar
		}

		// Parameter for recovering the vessel after the mission
		PARAMETER
		{
			name = ToBase
			type = All

			title = "Land the vessel and recover it safely on Kerbin"

			disableOnStateChange = true
			completeInSequence = true

			PARAMETER
			{
				name = LandBase
				type = ReturnHome

				title = "Stop the vessel on the surface"
			}

			PARAMETER
			{
				name = RecoverBase
				type = RecoverVessel

				title = "Recover the vessel"
				completedMessage = "The vessel was successfully recovered!"
			}
		}
	}
}
