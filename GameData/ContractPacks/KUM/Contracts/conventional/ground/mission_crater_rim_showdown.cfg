CONTRACT_TYPE
{
	name = kumCraterShowdown

	title = "Crater Rim SEAD Showdown"
	genericTitle = "Crater Rim SEAD Showdown"

	group = munistorumGround
	agent = komUniMun

	description = "We have detected a large number of hostile SAM sites on the Crater Rim west of the Desert Airfield. This has put a severe thorn in Valentina's holiday plans, you must go there and take them out." + "\n\nTake control of the location for the sake of our holidays!" + "\n\nMission Latitude: 8" +"\nMission Longitude: -180"
	genericDescription = "We have detected a large number of hostile SAM sites on the Crater Rim west of the Desert Airfield. This has put a severe thorn in Valentina's holiday plans, you must go there and take them out." + "\n\nTake control of the location for the sake of our holidays!"

	topic = Weapons
	subject = Experiment

	synopsis = "Eliminate all SAM sites in the crater rim."

	completedMessage = "Mission accomplished! completedMessage"

	minExpiry = 0.0
	maxExpiry = 0.0

	cancellable = true
	declinable = true

	targetBody = HomeWorld()

	maxCompletions = 0
	maxSimultaneous = 1

	// Data node for the rewards
	DATA
	{
		type = double

		science = 0.0 // Zero for non-test missions
		reputation = 14 * Random(0.8, 1.2)
		funds = 24000 * Random(0.8, 1.2)
	}

	// Name Safety
	DATA
	{
		type = int

		nameAppend = Random(0, 65535)

		hidden = true
	}

	// Target Names
	DATA
	{
		type = string
		title = "Target vessels"

		targetSAM1 = "SAM 1" + " ID: " + @/nameAppend
		targetSAM2 = "SAM 2" + " ID: " + @/nameAppend
		targetSAM3 = "SAM 3" + " ID: " + @/nameAppend
		targetSAM4 = "SAM 4" + " ID: " + @/nameAppend
		targetSAM5 = "SAM 5" + " ID: " + @/nameAppend

		targetRadar1 = "Radar 1" + " ID: " + @/nameAppend
		targetRadar2 = "Radar 2" + " ID: " + @/nameAppend
		targetRadar3 = "Radar 3" + " ID: " + @/nameAppend
		targetRadar4 = "Radar 4" + " ID: " + @/nameAppend
		targetRadar5 = "Radar 5" + " ID: " + @/nameAppend
	}

	// Vehicle Lists
	DATA
	{
		type = List<string>

		radarList = @/munistorumDataStore:radarList
		samList = @/munistorumDataStore:samList
	}

	// Vehicle Positions
	DATA
	{
		type = double

		sam1Lat = 9.297778
		sam1Lon = -172.183056
		sam1Hdg = 270

		sam2Lat = 1.005278
		sam2Lon = -176.543056
		sam2Hdg = 345

		sam3Lat = 1.724167
		sam3Lon = 175.400833
		sam3Hdg = 15

		sam4Lat = 12.521389
		sam4Lon = 172.668056
		sam4Hdg = 90

		sam5Lat = 8.310712
		sam5Lon = 179.877643
		sam5Hdg = 180
	}

	// Requirement node for contract prerequisites
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = kumRequiredGround
	}

	// Value definitions
	rewardScience = @/science
	rewardReputation = @/reputation
	rewardFunds = @/funds

	failureReputation = @/reputation / 4
	failureFunds = @/funds / 8
	advanceFunds = @/funds / 4
	
	// Behaviour such as vessel location, name etc

	// SAM sites
	BEHAVIOUR
	{
		name = SpawnSAM
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetSAM1
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/samList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam1Lat
			lon = @/sam1Lon
			height = 5

			heading = @/sam1Hdg
		}

		VESSEL
		{
			name = @/targetSAM2
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/samList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam2Lat
			lon = @/sam2Lon
			height = 5

			heading = @/sam2Hdg
		}

		VESSEL
		{
			name = @/targetSAM3
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/samList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam3Lat
			lon = @/sam3Lon
			height = 5

			heading = @/sam3Hdg
		}

		VESSEL
		{
			name = @/targetSAM4
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/samList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam4Lat
			lon = @/sam4Lon
			height = 5

			heading = @/sam4Hdg
		}

		VESSEL
		{
			name = @/targetSAM5
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/samList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam5Lat
			lon = @/sam5Lon
			height = 5

			heading = @/sam5Hdg
		}
	}

	// Radar sites
	BEHAVIOUR
	{
		name = SpawnRadar
		type = SpawnVessel
		deferVesselCreation = true

		VESSEL
		{
			name = @/targetRadar1
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/radarList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam1Lat - 0.002
			lon = @/sam1Lon
			height = 5

			heading = @/sam1Hdg
		}

		VESSEL
		{
			name = @/targetRadar2
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/radarList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam2Lat - 0.002
			lon = @/sam2Lon
			height = 5

			heading = @/sam2Hdg
		}

		VESSEL
		{
			name = @/targetRadar3
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/radarList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam3Lat - 0.002
			lon = @/sam3Lon
			height = 5

			heading = @/sam3Hdg
		}

		VESSEL
		{
			name = @/targetRadar4
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/radarList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam4Lat - 0.002
			lon = @/sam4Lon
			height = 5

			heading = @/sam4Hdg
		}

		VESSEL
		{
			name = @/targetRadar5
			craftURL = "ContractPacks/KUM/Assets/Ships/" + @/radarList.Random()
			flagURL = Squad/Flags/satellite
			vesselType = Unknown
			owned = false
			targetBody = HomeWorld()

			lat = @/sam5Lat - 0.002
			lon = @/sam5Lon
			height = 5

			heading = @/sam5Hdg
		}
	}

	// Destroy all mission vessels for safety
	BEHAVIOUR
	{
		name = ContingencyCleanup
		type = DestroyVessel

		onState = CONTRACT_FAILED

		vessel = @/targetSAM1
		vessel = @/targetSAM2
		vessel = @/targetSAM3
		vessel = @/targetSAM4
		vessel = @/targetSAM5

		vessel = @/targetRadar1
		vessel = @/targetRadar2
		vessel = @/targetRadar3
		vessel = @/targetRadar4
		vessel = @/targetRadar5
	}

	// Parameters for completing the contract

	// Combat parameters
	PARAMETER
	{
		name = CombatSequence
		type = Sequence

		title = "Eliminate the enemy"

		hiddenParameter = DestroyCraft

		PARAMETER
		{
			name = DestroyCraft
			type = TargetDestroyed

			title = "Eliminate the enemy"

			vessel = @/targetSAM1
			vessel = @/targetSAM2
			vessel = @/targetSAM3
			vessel = @/targetSAM4
			vessel = @/targetSAM5

			vessel = @/targetRadar1
			vessel = @/targetRadar2
			vessel = @/targetRadar3
			vessel = @/targetRadar4
			vessel = @/targetRadar5
		}

		// Parameter for recovering the vessel after the mission
		PARAMETER
		{
			name = ToBase
			type = All

			title = "Stop your vessel and recover it safely on Kerbin"

			disableOnStateChange = true
			completeInSequence = true

			PARAMETER
			{
				name = LandBase
				type = ReturnHome

				title = "Stop your vessel on the surface"
			}

			PARAMETER
			{
				name = RecoverBase
				type = RecoverVessel

				title = "Recover the vessel"
				completedMessage = "The vessel was successfully recovered!"
			}
		}
	}
}
